$(document).ready(function(){function getUrlParam(name){var reg=new RegExp("(^|&)"+ name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;}
var history_list=[];$.ajax({url:"index.php?route=common/dashboard/getHistoryPrice&token="+getUrlParam("token"),type:'post',data:'',dataType:"json",async:false,success:function(json){var test=JSON.stringify(json)
history_list=json;},error:function(xhr,ajaxOptions,thrownError){}});var language=$('html').attr('lang');var share_price='Share Price';var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var d=new Date();var month=monthNames[d.getMonth()]+' ';var day='';var text_date='Date';var referal_bonus='Referral';var leader_bonus='Leader';var cycle_bonus='Cycle';var pos_bonus='Pos';if(language=='cn'){share_price='股价';month=(d.getMonth()+1)+'月';day='日';text_date='日期';referal_bonus='推荐奖';leader_bonus='领导奖';cycle_bonus='对碰奖';pos_bonus='见点奖';}
var sin=history_list;var plot=$.plot($("#share"),[{data:sin,label:share_price}],{series:{shadowSize:0,lines:{show:true,lineWidth:2,},points:{show:true}},grid:{labelMargin:10,hoverable:true,clickable:true,borderWidth:1,borderColor:'#f5f5f5'},legend:{backgroundColor:'#fff'},yaxis:{tickColor:'#f5f5f5',font:{color:'#bdbdbd'},tickDecimals:3},xaxis:{mode:"categories",tickLength:0,tickColor:'#f5f5f5',font:{color:'#bdbdbd'},tickDecimals:2},colors:[Utility.getBrandColor('danger'),Utility.getBrandColor('inverse')],tooltip:true,tooltipOpts:{content:text_date+": %x"+day+", "+share_price+": $%y"}});var previousPoint=null;$("#share").bind("plothover",function(event,pos,item){$("#y").text(pos.y.toFixed(3));});$("#share").bind("plotclick",function(event,pos,item){if(item){$("#clickdata").text("You clicked point "+ item.dataIndex+" in "+ item.series.label+".");plot.highlight(item.series,item.datapoint);}});var bonus1=$('#bonus1').text().replace('$','');var bonus2=$('#bonus2').text().replace('$','');var bonus3=$('#bonus3').text().replace('$','');var bonus4=$('#bonus4').text().replace('$','');var datax=[{label:referal_bonus,data:bonus1,color:Utility.getBrandColor('a')},{label:pos_bonus,data:bonus3,color:Utility.getBrandColor('b')},{label:leader_bonus,data:bonus4,color:Utility.getBrandColor('d')},{label:cycle_bonus,data:bonus2,color:Utility.getBrandColor('c')}];$.plot($("#interactive"),datax,{series:{pie:{show:true}},grid:{hoverable:true,clickable:true},legend:{show:false},tooltip:true,tooltipOpts:{content:"%p.0%, %s"}});$("#interactive").bind("plothover",pieHover);function pieHover(event,pos,obj)
{if(!obj)
return;percent=parseFloat(obj.series.percent).toFixed(2);$("#hover").html('<span style="font-weight: bold; color: '+obj.series.color+'">'+obj.series.label+' ('+percent+'%)</span>');}});